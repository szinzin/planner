<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<title>📑 Timeline Dashboard</title>
<style>
body{margin:0;font:16px/1.5 system-ui,sans-serif;background:#f5f7fa;}
h1{margin:1.2rem;font-size:24px;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1.2rem;padding:1.2rem;}
.card{background:#fff;border-radius:12px;box-shadow:0 3px 8px rgb(0 0 0/.06);padding:1rem;display:flex;flex-direction:column;justify-content:space-between;}
.card a{text-decoration:none;color:#2563eb;font-weight:600;word-break:break-all;}
small{color:#6b7280;font-size:12px;}
</style>
<script>
async function load() {
  const user = location.hostname.split('.')[0];           // <user>.github.io
  const repo = location.pathname.replace(/^\/|\/$/g,'');  // -> repo
  const branch = 'main';                                  // change if needed

  /* 1️⃣  SHA du commit HEAD */
  const br = await fetch(`https://api.github.com/repos/${user}/${repo}/branches/${branch}`)
                   .then(r=>r.json());
  const sha = br.commit.sha;

  /* 2️⃣  Arbre complet */
  const tree = await fetch(`https://api.github.com/repos/${user}/${repo}/git/trees/${sha}?recursive=1`)
                     .then(r=>r.json());

  const grid = document.querySelector('.grid');
  tree.tree
      .filter(n => n.path.endsWith('.html') && n.path!=='index.html')
      .forEach(n=>{
        const el=document.createElement('div');
        el.className='card';
        el.innerHTML=`<a href="${n.path}" target="_blank">${n.path}</a>
                      <small>${(n.size/1024).toFixed(1)} KB</small>`;
        grid.appendChild(el);
      });
}
window.onload = load;
</script>
</head>
<body>
<h1>📑 Timelines du dépôt</h1>
<div class="grid"></div>
</body>
</html>